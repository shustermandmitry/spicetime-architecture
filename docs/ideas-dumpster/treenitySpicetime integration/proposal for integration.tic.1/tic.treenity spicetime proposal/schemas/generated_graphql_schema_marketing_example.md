# Example: Generated GraphQL Schema for Marketing Space

## **Overview**

This document provides an example of a GraphQL schema generated by observing Treenity patch streams for the `marketing`
space. The schema captures the entities (`Campaigns`, `Tasks`), relationships, and operations derived from patch
activities.

---

## **Schema Definition**

### **Entities**

#### **Campaign**

Represents a marketing campaign in the system. It is identified by its unique ID.

```graphql
type Campaign {
  id: ID!
  name: String!
  description: String
  status: String
  createdAt: String
  updatedAt: String
}
```

#### **Task**

Represents a task or activity associated with a campaign.

```graphql
type Task {
  id: ID!
  title: String!
  description: String
  status: String
  dueDate: String
  campaignId: ID!
}
```

---

### **Queries**

Queries expose entities and their relationships from the `marketing` space.

```graphql
type Query {
  # Fetch all campaigns
  listCampaigns(status: String): [Campaign]

  # Fetch a single campaign by its ID
  getCampaign(id: ID!): Campaign

  # Fetch all tasks associated with a specific campaign
  getTasksByCampaign(campaignId: ID!): [Task]
}
```

---

### **Mutations**

Mutations allow modifications to entities within the `marketing` space.

#### **Campaign Mutations**

```graphql
type Mutation {
  # Add a new campaign
  addCampaign(name: String!, description: String, status: String): Campaign

  # Update an existing campaign
  updateCampaign(id: ID!, name: String, description: String, status: String): Campaign

  # Delete a campaign by its ID
  deleteCampaign(id: ID!): Boolean
}
```

#### **Task Mutations**

```graphql
type Mutation {
  # Add a new task to a campaign
  addTask(campaignId: ID!, title: String!, description: String, status: String, dueDate: String): Task

  # Update an existing task
  updateTask(id: ID!, title: String, description: String, status: String, dueDate: String): Task

  # Delete a task by its ID
  deleteTask(id: ID!): Boolean
}
```

---

## **Example Resolvers**

### Resolver: Fetch Campaigns

The `listCampaigns` query uses filters (e.g., status) to return an array of campaigns.

```javascript
const resolvers = {
    Query: {
        listCampaigns: async (_, {status}) => {
            const data = await getCampaignsFromDatabase(); // Replace with actual data source

            // Apply any filters, e.g., by status
            return data.filter((campaign) => !status || campaign.status === status);
        },
    },
};
```

---

## **Usage Example**

### Query

Fetch all active campaigns with their associated tasks:

```graphql
query {
  listCampaigns(status: "active") {
    id
    name
    status
    tasks: getTasksByCampaign(campaignId: id) {
      id
      title
      status
    }
  }
}
```

### Mutation

Add a new campaign:

```graphql
mutation {
  addCampaign(name: "New Spring Campaign", description: "Focus on spring sales", status: "draft") {
    id
    name
    status
  }
}
```

---

## **Next Steps**

1. Extend the schema with additional entities (e.g., `Customer`, `Budget`).
2. Integrate permissions, ensuring only authorized users can access/modify campaigns.
3. Optimize resolver performance with caching for frequently accessed queries.